
define bind_self : (('A self -> 'B) -> ('A -> 'B))
{ dup bind }

define test
{ true [true] [false] if }

define rec_noop
{ [rec_noop] }

define bin_rec_noop
{ [bin_rec_noop] [bin_rec_noop] }

define m
{ dup apply }

define y
{ [dup bind] swap compose dup apply }

define eqz
{ dup 0 eq }

define dec
{ 1 sub_int }

define fix_step
{ [eqz] dip swap [pop] [[dec dup writeln] dip apply] if }

define fix_test
{ 10 [fix_step] y }

define aa : ('a -> 'a 'a)
{ dup }

define aaa : ('a -> 'a 'a 'a)
{ dup dup }

define aaaa : ('a -> 'a 'a 'a 'a)
{ dup dup dup }

define aaaa_2 : ('a -> 'a 'a 'a 'a)
{ aaa dup }

define pop2 : ('a 'b -> )
{ pop pop }

define pop3 : ('a 'b 'c -> )
{ pop pop pop }

define pop3_2 : ('adam 'bob 'carl -> )
{ pop pop2 }

define swapswap : ('a 'b -> 'a 'b)
{ swap swap }

define app_1 : ('A ('A -> 'B) -> 'B)
{ apply }

define app_2 : ('A ('A -> 'B) -> 'B)
{ true swap dup if }

define app_3 : ('A ('A -> 'B) -> 'B)
{ 42 swap dip pop }

define appapp : ('A ('A -> 'B ('B -> 'C)) -> 'C)
{ apply apply }

define inc_int : (int -> int)
{ 1 add_int }
